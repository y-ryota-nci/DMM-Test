#WF発注情報⇒発注情報を生成
BD0801_01: |+
 select /* BD0801_01 */ * from YR_MST where COMPANY_CD = ? and DLT_FG = '0' order by COMPANY_CD, YR_CD

#予算計画一覧を抽出
BD0801_02: |+
 select /* BD0801_02 */ P.*, ROWNUM as ID
 from V_BGT_PLN P
 where P.COMPANY_CD = ? and P.YR_CD = ? and P.ORGANIZATION_CODE = ? and P.RCV_COST_PAY_TP = ? and P.BS_PL_TP = ?
 order by P.COMPANY_CD, P.YR_CD, P.ORGANIZATION_CODE, P.BS_PL_TP, P.SORT_ORDER

#既存の予算計画を抽出
BD0801_03: |+
 select /* BD0801_03 */ * from BGT_PLN
 where COMPANY_CD = ? and YR_CD = ? and ORGANIZATION_CODE = ? and RCVINSP_PAY_TP = ? and DLT_FG = '0'

#組織階層ビューを抽出
BD0801_04: |+
 select /* BD0801_04 */ * from V_ORGANIZATION_LEVEL where CORPORATION_CODE = ? ${REPLACE}

#予算履歴バージョンの採番
BD0802_01: |+
 select /* BD0802_01 */ nvl(max(HST_VERSION), 0) from BGT_PLN_HSTVER
 where COMPANY_CD = ? and YR_CD = ? and ORGANIZATION_CODE = ? and RCVINSP_PAY_TP = ?

#予算履歴バージョ#予算履歴バージョンの抽出
BD0803_01: |+
 select /* BD0803_01 */
  ROWNUM as ID, V.COMPANY_CD, V.YR_CD, V.ORGANIZATION_CODE, V.RCVINSP_PAY_TP as RCV_COST_PAY_TP, V.HST_VERSION, V.HST_DT,
  V.HST_NM, V.HST_RMK, V.TIMESTAMP_UPDATED, V.USER_CODE_CREATED, U.USER_NAME as USER_NAME_CREATED
 from BGT_PLN_HSTVER V
  left join WFM_USER_V U
   on U.CORPORATION_CODE = V.COMPANY_CD
   and U.USER_CODE = V.USER_CODE_CREATED
   and U.LOCALE_CODE = ?
 where
  V.COMPANY_CD = ? and V.YR_CD = ? and V.ORGANIZATION_CODE = ? and V.RCVINSP_PAY_TP = ? and DLT_FG = '0'
  and exists (SELECT 1
                FROM BGT_PLN_HST X
                    ,BGT_ITM_MST Y
               WHERE X.COMPANY_CD = Y.COMPANY_CD
                 AND X.BGT_ITM_CD = Y.BGT_ITM_CD
                 AND Y.BS_PL_TP   = ?
                 AND X.COMPANY_CD = V.COMPANY_CD
                 AND X.YR_CD      = V.YR_CD
                 AND X.ORGANIZATION_CODE = V.ORGANIZATION_CODE
                 AND X.HST_VERSION = V.HST_VERSION
                 AND X.RCVINSP_PAY_TP = V.RCVINSP_PAY_TP)

#予算履歴バージョンの削除
BD0803_02: |+
 update BGT_PLN_HSTVER /* BD0803_02 */ set DLT_FG = '1'
 where COMPANY_CD = ? and YR_CD = ? and ORGANIZATION_CODE = ? and RCVINSP_PAY_TP = ? and HST_VERSION = ?

#予算履歴の削除
BD0803_03: |+
 update BGT_PLN_HST /* BD0803_03 */ set DLT_FG = '1'
 where COMPANY_CD = ? and YR_CD = ? and ORGANIZATION_CODE = ? and RCVINSP_PAY_TP = ? and HST_VERSION = ?

#予算履歴バージョンの選択肢を抽出
BD0808_01: |+
 select /* BD0808_01 */ * from BGT_PLN_HSTVER
 where COMPANY_CD = ? and YR_CD = ? and ORGANIZATION_CODE = ? and RCVINSP_PAY_TP = ? and DLT_FG = '0'

#予算計画
BD0808_02: |+
 select /* BD0808_02 */
    MAX(SORT_ORDER)           AS SORT_ORDER,
    MAX(TYPE_NAME)            AS TYPE_NAME,
    COMPANY_CD                AS COMPANY_CD,
    BGT_ITM_CD                AS BGT_ITM_CD,
    MAX(BGT_ITM_NM)           AS BGT_ITM_NM,
    MAX(BS_PL_TP)             AS BS_PL_TP,
    MAX(BS_PL_TP_NM)          AS BS_PL_TP_NM,
    MAX(YR_CD)                AS YR_CD,
    MAX(YR_NM)                AS YR_NM,
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    MAX(RCV_COST_PAY_TP)      AS RCV_COST_PAY_TP,
    MAX(RCV_COST_PAY_TP_NM)   AS RCV_COST_PAY_TP_NM,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    MAX(TIMESTAMP_UPDATED)    AS TIMESTAMP_UPDATED,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_PLN P
 where P.COMPANY_CD = ? and P.YR_CD = ? and P.RCV_COST_PAY_TP = ? ${REPLACE}
  group by P.COMPANY_CD, P.BGT_ITM_CD
  order by 6 desc ,1 asc

#支払実績
BD0808_05: |+
 select /* BD0808_05 */
    MAX(SORT_ORDER)           AS SORT_ORDER,
    MAX(TYPE_NAME)            AS TYPE_NAME,
    COMPANY_CD                AS COMPANY_CD,
    BGT_ITM_CD                AS BGT_ITM_CD,
    MAX(BGT_ITM_NM)           AS BGT_ITM_NM,
    MAX(BS_PL_TP)             AS BS_PL_TP,
    MAX(YR_CD)                AS YR_CD,
    MAX(YR_NM)                AS YR_NM,
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    MAX(RCV_COST_PAY_TP)      AS RCV_COST_PAY_TP,
    MAX(RCV_COST_PAY_TP_NM)   AS RCV_COST_PAY_TP_NM,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    MAX(BS_PL_TP)             AS BS_PL_TP,
    NVL(MAX(ROWNUM),1)        AS ID
  from V_BGT_RESULT_PAY R
 where R.COMPANY_CD = ? and R.YR_CD = ? and R.RCV_COST_PAY_TP = ? ${REPLACE}
  group by R.COMPANY_CD, R.BGT_ITM_CD
  order by 6 desc, 1 asc

#予算科目の選択肢
BD0808_07: |+
 select /* BD0808_07 */ * from BGT_ITM_MST where COMPANY_CD = ? and DLT_FG = '0'

#予算計画履歴
BD0808_08: |+
 select /* BD0808_08 */ H.*, ROWNUM as ID
 from V_BGT_PLN_HST H
 where H.COMPANY_CD = ? and H.YR_CD = ? and H.RCV_COST_PAY_TP = ? and H.ORGANIZATION_CODE = ? and H.HST_VERSION = ? ${REPLACE}
 order by H.COMPANY_CD, H.YR_CD, H.ORGANIZATION_CODE, H.BGT_ITM_CD, H.RCV_COST_PAY_TP, H.HST_VERSION

#費用実績
BD0808_09: |+
 select /* BD0808_09 */
    MAX(SORT_ORDER)           AS SORT_ORDER,
    MAX(TYPE_NAME)            AS TYPE_NAME,
    COMPANY_CD                AS COMPANY_CD,
    BGT_ITM_CD                AS BGT_ITM_CD,
    MAX(BGT_ITM_NM)           AS BGT_ITM_NM,
    MAX(BS_PL_TP)             AS BS_PL_TP,
    MAX(YR_CD)                AS YR_CD,
    MAX(YR_NM)                AS YR_NM,
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    MAX(RCV_COST_PAY_TP)      AS RCV_COST_PAY_TP,
    MAX(RCV_COST_PAY_TP_NM)   AS RCV_COST_PAY_TP_NM,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    MAX(BS_PL_TP)             AS BS_PL_TP,
    NVL(MAX(ROWNUM),1)        AS ID
  from V_BGT_RESULT_COST R
 where R.COMPANY_CD = ? and R.YR_CD = ? and R.RCV_COST_PAY_TP = ? ${REPLACE}
  group by R.COMPANY_CD, R.BGT_ITM_CD
  order by 6 desc, 1 asc

#予算科目の選択肢(BS/PL区別)
BD0808_11: |+
 select /* BD0808_11 */ * from BGT_ITM_MST where COMPANY_CD = ? and DLT_FG = '0'

#費用実績合計
BD0808_12: |+
 select /* BD0808_12 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_COST R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   and R.RCV_COST_PAY_TP = ?
   ${REPLACE}

#支払実績合計
BD0808_14: |+
 select /* BD0808_14 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_PAY R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   and R.RCV_COST_PAY_TP = ?
   ${REPLACE}

#前払増加
BD0808_15: |+
 select /* BD0808_15 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ADVPAY_INC R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#前払減少
BD0808_16: |+
 select /* BD0808_16 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ADVPAY_DEC R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#前払残高
BD0808_17: |+
 select /* BD0808_17 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ADVPAY_BAL R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#前払残高（前月）
BD0808_18: |+
 SELECT SUM(A.AMT) AS BGT_AMT_02, A.ORGNZ_CD, O.ORGANIZATION_CODE_UP, NVL(MAX(ROWNUM),1) AS ID

 FROM (
    SELECT NVL(SUM(BAL_AMT_INCTAX),0) AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ADVPAY_BAL
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM = (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ADVPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    GROUP BY COMPANY_CD,ORGNZ_CD
    UNION ALL
    SELECT NVL(SUM(PAY_AMT_INCTAX),0) AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ADVPAY_INC
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM > (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ADVPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    AND CST_ADD_YM < ?
    GROUP BY COMPANY_CD,ORGNZ_CD
    UNION ALL
    SELECT NVL(SUM(COST_AMT),0) * - 1 AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ADVPAY_DEC
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM > (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ADVPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    AND CST_ADD_YM <= ?
    GROUP BY COMPANY_CD,ORGNZ_CD
 ) A
    INNER JOIN WFM_ORGANIZATION_V O
        ON O.CORPORATION_CODE = A.COMPANY_CD
        AND O.ORGANIZATION_CODE = A.ORGNZ_CD
        AND O.DELETE_FLAG = '0'
        AND O.LOCALE_CODE = 'ja'
 WHERE 1 = 1
   ${REPLACE}
 GROUP BY A.ORGNZ_CD, O.ORGANIZATION_CODE_UP

#未払・買掛・買掛仮の増加
BD0808_19: |+
 select /* BD0808_19 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ACCPAY_INC R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#未払・買掛・買掛仮の減少
BD0808_20: |+
 select /* BD0808_20 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ACCPAY_DEC R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#未払・買掛・買掛仮の残高
BD0808_21: |+
 select /* BD0808_21 */
    MAX(ORGANIZATION_CODE)    AS ORGANIZATION_CODE,
    MAX(ORGANIZATION_NAME)    AS ORGANIZATION_NAME,
    MAX(ORGANIZATION_CODE_UP) AS ORGANIZATION_CODE_UP,
    MAX(ORGANIZATION_NAME_UP) AS ORGANIZATION_NAME_UP,
    NVL(SUM(BGT_AMT_03),0)    AS BGT_AMT_03,
    NVL(SUM(BGT_AMT_04),0)    AS BGT_AMT_04,
    NVL(SUM(BGT_AMT_05),0)    AS BGT_AMT_05,
    NVL(SUM(BGT_AMT_06),0)    AS BGT_AMT_06,
    NVL(SUM(BGT_AMT_07),0)    AS BGT_AMT_07,
    NVL(SUM(BGT_AMT_08),0)    AS BGT_AMT_08,
    NVL(SUM(BGT_AMT_09),0)    AS BGT_AMT_09,
    NVL(SUM(BGT_AMT_10),0)    AS BGT_AMT_10,
    NVL(SUM(BGT_AMT_11),0)    AS BGT_AMT_11,
    NVL(SUM(BGT_AMT_12),0)    AS BGT_AMT_12,
    NVL(SUM(BGT_AMT_01),0)    AS BGT_AMT_01,
    NVL(SUM(BGT_AMT_02),0)    AS BGT_AMT_02,
    NVL(MAX(ROWNUM),1)        AS ID
 from V_BGT_RESULT_ACCPAY_BAL R
 where R.COMPANY_CD = ?
   and R.YR_CD = ?
   ${REPLACE}

#未払・買掛・買掛仮の残高（前月）
BD0808_22: |+
 SELECT /* BD0808_22 */
    SUM(A.AMT) AS BGT_AMT_02, A.ORGNZ_CD, O.ORGANIZATION_CODE_UP, NVL(MAX(ROWNUM),1) AS ID
 FROM (
    SELECT NVL(SUM(ACCPAY_AMT),0) AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ACCPAY_BAL
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM = (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ACCPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    GROUP BY COMPANY_CD,ORGNZ_CD
    UNION ALL
    SELECT NVL(SUM(ACCPAY_AMT_INCTAX),0) AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ACCPAY_INC
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM > (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ACCPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    AND CST_ADD_YM <= ?
    GROUP BY COMPANY_CD,ORGNZ_CD
    UNION ALL
    SELECT NVL(SUM(ACCPAY_AMT),0) * - 1 AS AMT
          ,COMPANY_CD
          ,ORGNZ_CD
    FROM V_BGT_MONTH_RESULT_ACCPAY_DEC
    WHERE COMPANY_CD = ?
    AND CST_ADD_YM > (SELECT MAX(CST_ADD_YM) FROM V_BGT_MONTH_RESULT_ACCPAY_BAL WHERE COMPANY_CD = ? AND CST_ADD_YM <= ?)
    AND CST_ADD_YM <= ?
    GROUP BY COMPANY_CD,ORGNZ_CD
 ) A
    INNER JOIN WFM_ORGANIZATION_V O
        ON O.CORPORATION_CODE = A.COMPANY_CD
        AND O.ORGANIZATION_CODE = A.ORGNZ_CD
        AND O.DELETE_FLAG = '0'
        AND O.LOCALE_CODE = 'ja'
 WHERE 1 = 1
   ${REPLACE}
 GROUP BY A.ORGNZ_CD, O.ORGANIZATION_CODE_UP

#費用実績
BD0809_01: |+
 select /* BD0809_01 */ ${REPLACE} from V_BD0809_COST X
 where COMPANY_CD = ? and CST_ADD_YM = ? and ORGANIZATION_CODE_LV3 = ?

#支払実績
BD0809_02: |+
 select /* BD0809_02 */ ${REPLACE} from V_BD0809_PAY X
 where COMPANY_CD = ? and CST_ADD_YM = ? and ORGANIZATION_CODE_LV3 = ?

